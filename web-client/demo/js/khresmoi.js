var origText="";function translate(){$("#cannot").fadeOut();origText=$("#src").val();if(!origText||0==origText.length){return}srcLang=$("input[name=radio-src]:checked").attr("l");destLang=$("input[name=radio-dest]:checked").attr("l");if((srcLang!="en"&&destLang!="en")||(srcLang==destLang)){$("#cannot").fadeIn();return}$(".working").fadeIn();var a={action:"translate",text:origText,sourceLang:srcLang,targetLang:destLang,alignmentInfo:"true"};$("#q").text(JSON.stringify(a,undefined,2));$.post("query.php",a,function(b){show(b)},"json")}var k=0;function show(d){$(".working").fadeOut();var b=d.translation[0]["translated"];var a="";for(var c=0;c<b.length;c++){a+=b[c]["text"]+" "}$("#dest").val(a);$("#align").empty();$("#align").append("<h1>Phrase alignment information (mouse hover)</h1>");k=0;b.forEach(oneSentence);setupHovers();$("#align").fadeIn("slow");for(var c=0;c<d.translation[0]["translated"].length;c++){delete d.translation[0]["translated"][c]["zipped-alignment"];delete d.translation[0]["translated"][c]["original"]}$("#r").text(JSON.stringify(d,undefined,2))}function oneSentence(g){var f=g["zipped-alignment"];var h=$('<div class="sentence" />');for(var b=1;b>=0;b--){var a=$('<div class="line" />');for(var d=0;d<f.length;d++){var c=f[d][b];a.append('<span class="token" tokenorder="'+(d+10000*k)+'">'+c+"</span>")}h.append(a)}$("#align").append(h);k++}var typingTimer;var doneTypingInterval=900;function prep(){prep_timer()}function prep_timer(){}function doneTyping(){clearTimeout(typingTimer);translate()}function setupHovers(){$("span.token").hover(function(){var a=$(this);var b=a.attr("tokenorder");$("[tokenorder = "+b+"]").addClass("hover")},function(){var a=$(this);var b=a.attr("tokenorder");$("[tokenorder = "+b+"]").removeClass("hover")})}function rb(b,a){}function langSetup(a){clearTimeout(typingTimer);$("#dest").val("");$("#align").fadeOut();if(a){$("#radio5").hide();$('label[for="radio5"]').hide();for(var b=6;b<=8;b++){$("#radio"+b).fadeIn();$('label[for="radio'+b+'"]').fadeIn()}}else{for(var b=6;b<=8;b++){$("#radio"+b).hide();$('label[for="radio'+b+'"]').hide()}$("#radio5").fadeIn();$('label[for="radio5"]').fadeIn()}}function design(){$("#src").focus();$("#radio6").click(function(){doneTyping()});$("#radio7").click(function(){doneTyping()});$("#radio8").click(function(){doneTyping()});$("#go").mouseup(function(){console.log("go");doneTyping()});$("#detail-show").click(function(){$("#detail").fadeToggle(380)});$("#radio1").click(function(){$("#radio7").attr("checked","checked");langSetup(true);doneTyping()});$("#radio2").click(function(){$("#radio5").attr("checked","checked");langSetup(false);doneTyping()});$("#radio3").click(function(){$("#radio5").attr("checked","checked");langSetup(false);doneTyping()});$("#radio4").click(function(){$("#radio5").attr("checked","checked");langSetup(false);doneTyping()})}$(document).ready(function(){prep();design()});